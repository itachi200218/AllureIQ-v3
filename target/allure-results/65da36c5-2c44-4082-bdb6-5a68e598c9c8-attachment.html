<html>
<head>
    <meta charset='UTF-8'>
    <style>
        body { font-family:'Segoe UI',sans-serif;background:#f5f8fa;padding:25px;line-height:1.6; }
        h2,h3 { color:#0D47A1;margin-bottom:8px; }
        .subproject-card {
            background:#ffffff;
            border-left:6px solid #4285F4;
            border-radius:10px;
            padding:15px 20px;
            margin-bottom:20px;
            box-shadow:0 4px 10px rgba(0,0,0,0.08);
            transition: transform 0.2s ease;
        }
        .subproject-card:hover { transform: translateY(-2px); }
        .global-summary {
            background:#E3F2FD;
            padding:18px;
            border-left:6px solid #1A73E8;
            border-radius:10px;
            margin-bottom:25px;
        }
        .summary-footer {
            background:#E8EAF6;
            padding:15px;
            border-left:6px solid #3F51B5;
            border-radius:10px;
            margin-top:30px;
            font-size:14px;
        }
        .ai-search {
            background:#fff;
            border-left:6px solid #6C63FF;
            border-radius:10px;
            padding:15px;
            margin-bottom:25px;
            box-shadow:0 4px 10px rgba(0,0,0,0.08);
        }
        p { margin:6px 0; }
        code { background:#f0f3f6;padding:2px 5px;border-radius:4px; }
        input,button { font-size:14px; }
    </style>
</head>
<body>
    <h2>ğŸ“Š AI Subproject Analysis â€” null</h2>

    <div class='ai-search'>
        <h3>ğŸ” Search Historical AI Data</h3>
        <input id='searchInput' type='text' placeholder='Search keyword (e.g., login, error, endpoint)'
            style='padding:8px;width:60%;border-radius:8px;border:1px solid #ccc;'>
        <button onclick='searchAIData()'
            style='padding:8px 15px;background-color:#0078D7;color:white;border:none;border-radius:8px;margin-left:10px;'>
            Search
        </button>
        <div id='searchResults' style='margin-top:20px;'></div>
    </div>

    <div class='global-summary'>
    <h2>ğŸŒ Global Summary</h2>
    <p><b>Success Rate:</b> 100.00%<br>
    <b>Subprojects:</b> 3<br>
    <b>Endpoints Processed:</b> 32<br></p>
</div>
<h2 style='color:#1565C0;'>ğŸ§  Project Execution Summary â€” AllureIQ-v3-main</h2><hr style='border:1px solid #ccc;'><div class='project-card'><h2>ğŸš€ Project: AllureIQ-v3-main</h2><div class='subproject-card'><h3>ğŸ“¦ Subproject: FoodFinder01</h3><p>ğŸ•’ <b>Previous:</b> 2025-11-15T07:12:45.659933100Z (14 endpoints)<br>
ğŸ•’ <b>Latest:</b> 2025-11-15T07:34:45.400005800Z (14 endpoints)</p>
<p>ğŸ“ˆ Success Rate: 100.00% â†’ 100.00% (+0.00%)<br>
âŒ Failures: 0 â†’ 0</p>
â• Added: [GET /api/auth/profile/admin_1763192079862]<br>â– Removed: [GET /api/auth/profile/admin_1763190760549]<br><p style='color:#616161;font-weight:600;'>
ğŸ§¾ <b>Summary:</b> Between <b>2025-11-15T07:12:45.659933100Z</b> and <b>2025-11-15T07:34:45.400005800Z</b>, subproject <b>FoodFinder01</b> showed no major change â€”
from <b>100.00%</b> (0 fails) to <b>100.00%</b> (0 fails). It maintained stability overall (Î” +0.00%).
</p>
</div><div class='subproject-card'><h3>ğŸ“¦ Subproject: FoodFinderTest</h3><p>ğŸ•’ <b>Previous:</b> 2025-11-12T10:15:22.399643300Z (14 endpoints)<br>
ğŸ•’ <b>Latest:</b> 2025-11-12T10:34:00.609523300Z (14 endpoints)</p>
<p>ğŸ“ˆ Success Rate: 100.00% â†’ 100.00% (+0.00%)<br>
âŒ Failures: 0 â†’ 0</p>
â• Added: [GET /api/auth/profile/admin_1762943635035]<br>â– Removed: [GET /api/auth/profile/admin_1762942517137]<br><p style='color:#616161;font-weight:600;'>
ğŸ§¾ <b>Summary:</b> Between <b>2025-11-12T10:15:22.399643300Z</b> and <b>2025-11-12T10:34:00.609523300Z</b>, subproject <b>FoodFinderTest</b> showed no major change â€”
from <b>100.00%</b> (0 fails) to <b>100.00%</b> (0 fails). It maintained stability overall (Î” +0.00%).
</p>
</div><div class='subproject-card'><h3>ğŸ“¦ Subproject: TrackerTest</h3><p>ğŸ•’ <b>Previous:</b> 2025-11-12T15:01:26.109936Z (4 endpoints)<br>
ğŸ•’ <b>Latest:</b> 2025-11-12T15:14:32.761998100Z (4 endpoints)</p>
<p>ğŸ“ˆ Success Rate: 100.00% â†’ 100.00% (+0.00%)<br>
âŒ Failures: 0 â†’ 0</p>
â• Added: [DELETE https://student-job-tracker-1-q8rh.onrender.com/api/jobs/6914a14649ac1ed96750ef8d]<br>â– Removed: [DELETE https://student-job-tracker-1-q8rh.onrender.com/api/jobs/6914a05f49ac1ed96750ef88]<br><p style='color:#616161;font-weight:600;'>
ğŸ§¾ <b>Summary:</b> Between <b>2025-11-12T15:01:26.109936Z</b> and <b>2025-11-12T15:14:32.761998100Z</b>, subproject <b>TrackerTest</b> showed no major change â€”
from <b>100.00%</b> (0 fails) to <b>100.00%</b> (0 fails). It maintained stability overall (Î” +0.00%).
</p>
</div></div>

 <script>
     async function searchAIData() {
         const query = document.getElementById("searchInput").value.trim();
         const resultsDiv = document.getElementById("searchResults");
         if (!query) {
             resultsDiv.innerHTML = "<p style='color:red;'>Please enter a search keyword.</p>";
             return;
         }
         resultsDiv.innerHTML = "<p>â³ Searching...</p>";

         // âœ… Automatically detect environment
         const isLocal = window.location.hostname.includes("localhost") || window.location.hostname.startsWith("192.");
         const baseUrl = isLocal
             ? "http://localhost:8081"  // local Spring Boot
             : "https://ai-allure-reuse-luffy.onrender.com"; // deployed Render backend

         try {
             const res = await fetch(`${baseUrl}/api/search?q=${encodeURIComponent(query)}`);
             if (!res.ok) throw new Error("Server not reachable");
             const data = await res.json();

             if (!data.results || Object.keys(data.results).length === 0) {
                 resultsDiv.innerHTML = "<p>No results found for <b>" + query + "</b>.</p>";
                 return;
             }

             let html = "";

             // âœ… Show AI summary FIRST (top of search results)
            // âœ… Enhanced AI summary (bullet-point style)
                if (data.ai_summary) {
                    html += `
                        <div style="
                            background:linear-gradient(135deg,#ede7f6,#f3e5f5);
                            border-left:6px solid #7B1FA2;
                            padding:15px 20px;
                            border-radius:12px;
                            box-shadow:0 3px 10px rgba(123,31,162,0.15);
                            margin-bottom:20px;
                            font-family:'Segoe UI',sans-serif;
                        ">
                            <h3 style="color:#4A148C;margin-bottom:10px;">ğŸ§  AI Summary Insights</h3>
                            <ul style="list-style:none;padding-left:0;margin:0;">
                                ${data.ai_summary.split('\n').map(line => {
                                    if (line.trim().startsWith('-')) {
                                        return `<li style="margin-bottom:6px;">ğŸ”¹ ${line.replace('-', '').trim()}</li>`;
                                    } else if (line.trim().startsWith('*')) {
                                        return `<li style="margin-bottom:6px;">âœ¨ ${line.replace('*', '').trim()}</li>`;
                                    } else {
                                        return `<li style="margin-bottom:6px;">ğŸ’¡ ${line.trim()}</li>`;
                                    }
                                }).join('')}
                            </ul>
                        </div>`;
                }

             // âœ… Then show all MongoDB collection results
             for (const [collection, docs] of Object.entries(data.results)) {
                 html += `<h4 style='color:#0078D7;'>ğŸ“‚ ${collection}</h4>`;
                 if (docs.length === 0) {
                     html += "<p><i>No entries found.</i></p>";
                 } else {
                     docs.forEach(doc => {
                         html += `<pre style='background:#f8f9fa;padding:10px;border-radius:6px;border:1px solid #ddd;'>${JSON.stringify(doc,null,2)}</pre>`;
                     });
                 }
             }

             resultsDiv.innerHTML = html;
         } catch (err) {
             resultsDiv.innerHTML = `<p style='color:red;'>âŒ Failed to fetch data: ${err.message}</p>`;
         }
     }
     </script>


</body>
</html>
